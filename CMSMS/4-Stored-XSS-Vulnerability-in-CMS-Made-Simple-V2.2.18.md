# 4-Stored-XSS-Vulnerability-in-CMS-Made-Simple-V2.2.18.md

CMS Made Simple(https://www.cmsmadesimple.org/)is an Open Source Content Management System. Itâ€™s built using PHP and the Smarty Engine, which keeps content, functionality, and templates separated. 

Vulnerability Title:1-Stored-XSS-Vulnerability-in-CMS-Made-Simple

Affected Version: 2.2.18

Discovery time: 2023.11.16
 

Discovered by: t34t
 

Analysis Report: 

(A) vulnerability verification process
Vulnerability environment: `windows+ apache+php7.4`
The source code is downloaded from the official website:
`https://www.cmsmadesimple.org/downloads/cmsms`
Then follow the prompts to install.

**Vulnerability details:**
Login  to the administrator background, in the Site Admin section, you can edit "Settings - News module",then in Filed Definitions,attacker can add Field Definition,a attact vector as Name value:

`<svg><animate attributename="x" dur="1s" onbegin="alert(1)"></animate></svg>`

![Alt text](<Screenshot 2023-11-16 at 20.35.48.png>)

When user visit the this website , preparing to write an article or clicking an article and read already published by the attacker, the javascript code alert(1) is executed:

![Alt text](<Screenshot 2023-11-16 at 20.40.21.png>)

![Alt text](<Screenshot 2023-11-16 at 20.41.06.png>)

Patch Program:
Strict filtering of user input code in Field Definition name.
