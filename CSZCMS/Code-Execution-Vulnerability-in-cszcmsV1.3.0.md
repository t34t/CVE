## Code-Execution-Vulnerability-in-cszcmsV1.3.0

CSZ CMS is an open source web application that allows to manage all content and settings on the websites. (https://www.cszcms.com/) 

Vulnerability Title: Code Execution Vulnerability in cszcmsV1.3.0

Affected Version: V1.3.0

Discovery time: 2023.11.16
 

Discovered by: t34t
 
Analysis Report: 

(A) vulnerability verification process
Vulnerability environment: `windows+apache+php7+mysql`
The source code is downloaded from the official website:
`https://www.cszcms.com/product/download`
Then follow the prompts to install.

**Vulnerability details:**
Login  to the administrator background,In ContentMenu->FileManager section, you can first create a template vulntest, click on create, will be in the CSZCMS-V1.3.0\cszcms\views\templates under the generation of directory named vulntest, which contains a main.php file, the same in the website. You can see theï¼š

![Alt text](<Screenshot 2023-11-16 at 15.52.07-1.png>)
Although you can't edit main.php here, you can create a file with the same name to override it.So here we edit a main.php with php backdoor content ourselves and then upload it for file overwriting.
![Alt text](<Screenshot 2023-11-16 at 15.59.21.png>)
The contents of main.php are
![Alt text](<Screenshot 2023-11-16 at 15.58.51.png>)

Then configure the theme for the site on the http://172.16.56.137/CSZCMS-V1.3.0/admin/settings page, configuring it to the template we just created.

![Alt text](<Screenshot 2023-11-16 at 16.00.49.png>)

Then visit the homepage of the site and access the backdoor and execute the command

![Alt text](<Screenshot 2023-11-16 at 16.03.23.png>)

Patch Program:
Restrictions on uploading, modifying, and renaming php files.

CVE-2023-6302